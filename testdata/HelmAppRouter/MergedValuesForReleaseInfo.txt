{"affinity":{},"args":["-l","$loglevel","-c","/config/envoy.yaml"],"command":["/usr/local/bin/envoy"],"env":{},"files":{"envoy.yaml":"## refs:\n## - https://www.envoyproxy.io/docs/envoy/latest/start/start#quick-start-to-run-simple-example\n## - https://raw.githubusercontent.com/envoyproxy/envoy/master/configs/google_com_proxy.v2.yaml\nadmin:\n  access_log_path: /dev/stdout\n  address:\n    socket_address:\n      address: 0.0.0.0\n      port_value: 9901\n\nstatic_resources:\n  listeners:\n  - name: listener_0\n    address:\n      socket_address:\n        address: 0.0.0.0\n        port_value: 10000\n    filter_chains:\n    - filters:\n      - name: envoy.http_connection_manager\n        config:\n          access_log:\n          - name: envoy.file_access_log\n            config:\n              path: /dev/stdout\n          stat_prefix: ingress_http\n          route_config:\n            name: local_route\n            virtual_hosts:\n            - name: local_service\n              domains: [\"*\"]\n              routes:\n              - match:\n                  prefix: \"/\"\n                route:\n                  host_rewrite: www.google.com\n                  cluster: service_google\n          http_filters:\n          - name: envoy.router\n  clusters:\n  - name: service_google\n    connect_timeout: 0.25s\n    type: LOGICAL_DNS\n    dns_lookup_family: V4_ONLY\n    lb_policy: ROUND_ROBIN\n    hosts:\n      - socket_address:\n          address: google.com\n          port_value: 443\n    tls_context:\n      sni: www.google.com"},"image":{"pullPolicy":"IfNotPresent","repository":"envoyproxy/envoy","tag":"v1.11.1"},"lifecycle":{},"livenessProbe":{"initialDelaySeconds":30,"tcpSocket":{"port":"admin"}},"nodeSelector":{},"podAnnotations":{},"podDisruptionBudget":"maxUnavailable: 1\n","podLabels":{},"ports":{"admin":{"containerPort":9901,"protocol":"TCP"},"n0":{"containerPort":10000,"protocol":"TCP"}},"priorityClassName":"","prometheusRule":{"additionalLabels":{},"enabled":false,"groups":{"upstream-rules":{"enabled":true,"rules":{"high4xxRate":{"alert":"High4xxRate","annotations":{"description":"The 4xx error response rate for envoy cluster {{ $labels.envoy_cluster_name }} reported a service replication success rate of {{ $value }}% for more than 1 minute.","summary":"4xx response rate above 1%"},"enabled":true,"expr":"sum(rate(envoy_cluster_upstream_rq_xx{response_code_class=\"4\"}[1m])) / sum(rate(envoy_cluster_upstream_rq_xx[1m])) * 100 \u003e 1","for":"1m","labels":{"severity":"page"}}}}}},"readinessProbe":{"initialDelaySeconds":30,"tcpSocket":{"port":"admin"}},"replicaCount":2,"resources":{},"secretMounts":{},"securityContext":{},"service":{"annotations":{},"enabled":true,"loadBalancerIP":"","name":"envoy","ports":{"n0":{"port":10000,"protocol":"TCP","targetPort":"n0"}},"type":"ClusterIP"},"serviceMonitor":{"additionalLabels":{},"enabled":false,"interval":"15s","podTargetLabels":[],"targetLabels":[]},"strategy":"type: RollingUpdate\nrollingUpdate:\n  maxSurge: 2\n  maxUnavailable: 1\n","terminationGracePeriodSeconds":30,"tolerations":[]}